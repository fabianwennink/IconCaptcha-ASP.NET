/*! IconCaptcha v3.1.3 | (c) 2023, Fabian Wennink (fabianwennink.nl) | fabianwennink.nl/projects/IconCaptcha-Widget/license */
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var IconCaptchaPolyfills=function(){var e={extend:function(e){e=e||{};for(var t=1;t<arguments.length;t++){var a=arguments[t];if(a)for(var n in a)a.hasOwnProperty(n)&&("object"===_typeof(a[n])?a[n]instanceof Array?e[n]=a[n].slice(0):e[n]=IconCaptchaPolyfills.extend(e[n],a[n]):e[n]=a[n])}return e},ajax:function(){var t=(t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})||{},a=new XMLHttpRequest;if(a.open(t.type||"get",t.url,t.async||!0),t.success&&(a.onload=function(){if(200===a.status)try{t.success(JSON.parse(a.responseText))}catch(e){t.success(a.responseText)}else t.error&&t.error({message:"Request returned ".concat(a.status,".")})}),t.error&&(a.onerror=function(e){return t.error(e)}),t.headers)for(var e in t.headers)a.setRequestHeader(e,t.headers[e]);if(a.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.data)if(t.processData=t.processData||!0,t.data instanceof FormData||t.processData){if(t.data=t.data||{},t.processData&&"object"===_typeof(t.data)){var n,o=new FormData;for(n in t.data)o.append(n,t.data[n]);t.data=o}a.send(t.data)}else a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify(t.data));else a.send()},trigger:function(e,t,a){var n=null;window.CustomEvent&&"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)},empty:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},offset:function(e){if(!e.getClientRects().length)return{top:0,left:0};var t=e.getBoundingClientRect(),e=e.ownerDocument.defaultView;return{top:t.top+e.pageYOffset,left:t.left+e.pageXOffset}},width:function(e){return parseFloat(getComputedStyle(e,null).width.replace("px",""))}};return e}();function ownKeys(t,e){var a,n=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(a),!0).forEach(function(e){_defineProperty(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _createForOfIteratorHelper(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==a.return||a.return()}finally{if(c)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(a="Object"===a&&e.constructor?e.constructor.name:a)||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var IconCaptcha=function(){var e={},c={general:{validationPath:null,fontFamily:null,credits:"show"},security:{clickDelay:1500,hoverDetection:!0,enableInitialMessage:!0,initializeDelay:500,selectionResetDelay:3e3,loadingAnimationDelay:1e3,invalidateTime:12e4},messages:{initialization:{loading:"Loading challenge...",verify:"Verify that you are human."},header:"Select the image displayed the <u>least</u> amount of times",correct:"Verification complete.",incorrect:{title:"Uh oh.",subtitle:"You've selected the wrong image."},timeout:{title:"Please wait 60 sec.",subtitle:"You made too many incorrect selections."}}},k="https://www.fabianwennink.nl/projects/IconCaptcha",A="IconCaptcha by Fabian Wennink";e.$init=function(e,t){return a(this,e,t)},e.init=function(e,t){e=Array.from(document.querySelectorAll(e));return a(this,e,t)},e.reset=function(t){return void 0===this.instances?console.error("IconCaptcha has not yet been initialized. Cannot use 'reset' yet."):n(this.instances,function(e){void 0!==t&&e.id!==t||null!=e&&e.reset()}),this},e.bind=function(t,a){return void 0===this.instances?console.error("IconCaptcha has not yet been initialized. Cannot use 'bind' yet."):n(this.instances,function(e){e.element.addEventListener(t,a)}),this};var a=function(e,t,a){if(void 0===e.instances||!t.some(function(e){return null!==e.querySelector(".iconcaptcha-modal")})){void 0===e.instances&&(e.instances={});var n=IconCaptchaPolyfills.extend({},c,a||{}),o=Object.values(e.instances).length;e.instances[o]=[];for(var i=0;i<t.length;i++)e.instances[o].push(l(t[i],i,n));return r(e.instances[o])}console.error("IconCaptcha has already been initialized on one or more elements in this list:",t)},n=function(e,t){for(var a=0,n=Object.values(e);a<n.length;a++)for(var o=n[a],i=0,c=Object.values(o);i<c.length;i++)t(c[i])},r=function(o){var e={reset:function(e){var t,a=_createForOfIteratorHelper(o);try{for(a.s();!(t=a.n()).done;){var n=t.value;void 0!==e&&n.id!==e||null!=n&&n.reset()}}catch(e){a.e(e)}finally{a.f()}return this},bind:function(e,t){var a,n=_createForOfIteratorHelper(o);try{for(n.s();!(a=n.n()).done;)a.value.element.addEventListener(e,t)}catch(e){n.e(e)}finally{n.f()}return this}};return e},l=function(e,t,o){var a,i,n,c,r=r||(a=Math.pow(10,13)-1,Math.floor(Math.random()*a)),l=e,s=!1,d=null,u=0,p=!1,f=0,h=!1,y=!1;if(o.general.validationPath)return v(),{id:r,element:e,reset:function(){C(),y=h=p=s=!1,IconCaptchaPolyfills.trigger(l,"reset",{captchaId:r}),v()}};function v(){c=null===(e=document.querySelector('input[name="_iconcaptcha-token"]'))||void 0===e?void 0:e.value;var e,t=l.getAttribute("data-theme")||"light";if(l.classList.add("iconcaptcha-theme-"+t),o.general.fontFamily&&(l.style.fontFamily=o.general.fontFamily),!s&&o.security.enableInitialMessage)return o.security.enableInitialMessage&&l.addEventListener("click",function(e){s||e.target instanceof HTMLAnchorElement||(s=!0,l.querySelector(".iconcaptcha-modal__body-circle").style.animationDuration="2s",l.querySelector(".iconcaptcha-modal__body-title").innerText=o.messages.initialization.loading,setTimeout(function(){l.classList.remove("iconcaptcha-init"),v()},o.security.initializeDelay))}),e=["<div class='iconcaptcha-modal'>","<div class='iconcaptcha-modal__body'>","<div class='iconcaptcha-modal__body-circle'></div>","<div class='iconcaptcha-modal__body-info'>","<a href='".concat(k,"' target='_blank' rel='follow' title='").concat(A,"'>IconCaptcha &copy;</a>"),"</div>","<div class='iconcaptcha-modal__body-title'>".concat(o.messages.initialization.verify,"</div>"),"</div>","</div>"],l.classList.add("iconcaptcha-init"),l.classList.remove("iconcaptcha-error","iconcaptcha-success"),void(l.innerHTML=e.join(""));p||function(){var e=[];{var t;e.push("<div class='iconcaptcha-modal'>","<div class='iconcaptcha-modal__header'>","<span>".concat(o.messages.header,"</span>"),"</div>","<div class='iconcaptcha-modal__body'>","<div class='iconcaptcha-modal__body-icons'></div>","</div>","<div class='iconcaptcha-modal__footer'>"),"show"!==o.general.credits&&"hide"!==o.general.credits||(t="hide"===o.general.credits?"display: none":"",e.push("<span style='".concat(t,"'><a href='").concat(k,"' target='_blank' rel='follow' title='").concat(A,"'>IconCaptcha</a> &copy;</span>")))}e.push("</div>","<div class='iconcaptcha-modal__fields'>","<input type='hidden' name='ic-hf-se' required />","<input type='hidden' name='ic-hf-id' value='".concat(r,"' required />"),"<input type='hidden' name='ic-hf-hp' required />","</div>"),e.push("</div>"),l.innerHTML=e.join(""),i=l.querySelector(".iconcaptcha-modal__body")}(),I(),o.security.loadingAnimationDelay&&0<o.security.loadingAnimationDelay&&!o.security.enableInitialMessage?setTimeout(function(){return m(t)},o.security.loadingAnimationDelay):m(t)}function m(e){e=S({i:r,a:1,t:e,tk:c});IconCaptchaPolyfills.ajax({url:o.general.validationPath,type:"POST",headers:j(c),data:{payload:e},success:function(e){if(e&&"string"==typeof e){var t=JSON.parse(atob(e));if(t.error)return void function(e,t){switch(e=parseInt(e)){case 1:_(o.messages.timeout.title,o.messages.timeout.subtitle,!1);var a=l.querySelector(".iconcaptcha-modal__header");a.parentNode.removeChild(a),IconCaptchaPolyfills.trigger(l,"timeout",{captchaId:r}),setTimeout(function(){return w(!1)},t);break;case 2:P(!0,"The captcha token is missing or is incorrect.","A server request was made without including a captcha token, however this option is enabled.");break;default:P(!0,"An unexpected error occurred.","An unexpected error occurred while IconCaptcha performed an action.")}}(t.error,t.data);var a=S({i:r,tk:c}),e=-1<o.general.validationPath.indexOf("?")?"&":"?",t=i.querySelector(".iconcaptcha-modal__body-icons");t.style.backgroundImage="url(".concat(o.general.validationPath).concat(e,"payload=").concat(a,")"),function(e){var t=e.style.backgroundImage.match(/\((.*?)\)/)[1].replace(/(['"])/g,""),e=new Image;e.onload=function(){var e;i.classList.remove("captcha-opacity");var t=i.querySelector(".captcha-loader");null==t||null!==(e=t.parentNode)&&void 0!==e&&e.removeChild(t)},e.src=t,e.complete&&e.onload(this)}(t),t.parentNode.insertAdjacentHTML("beforeend",'<div class="iconcaptcha-modal__body-selection"><i></i></div>'),n=i.querySelector(".iconcaptcha-modal__body-selection > i"),function(e){for(var t in e._ic_listeners={click:function(e){var t,a,n;new Date-f<=o.security.clickDelay||o.security.hoverDetection&&!y||(t=IconCaptchaPolyfills.offset(e.currentTarget),a=e.pageX-t.left,n=e.pageY-t.top,a&&n&&(i.classList.contains("captcha-opacity")||(IconCaptchaPolyfills.trigger(l,"selected",{captchaId:r}),o.security.loadingAnimationDelay&&0<o.security.loadingAnimationDelay?(I(),setTimeout(function(){return b(a,n)},o.security.loadingAnimationDelay)):b(a,n))))},mousemove:function(e){y&&!h&&p&&T(e)},mouseenter:function(e){n.style.display="inline",T(e),y=!0},mouseleave:function(){n.style.display="none",y=!1}},e._ic_listeners)e.addEventListener(t,e._ic_listeners[t])}(l.querySelector(".iconcaptcha-modal__body-selection")),p||IconCaptchaPolyfills.trigger(l,"init",{captchaId:r});t=i.querySelector(".iconcaptcha-modal__body-selection");return u=IconCaptchaPolyfills.width(t),f=new Date,p=!0,void(d=setTimeout(function(){return w(!0)},o.security.invalidateTime))}P(!0,"The IconCaptcha could not be loaded.","Invalid data was returned by the captcha back-end service. Make sure IconCaptcha is installed/configured properly.")},error:function(){return _()}})}function g(){l.classList.remove("iconcaptcha-error"),l.querySelector("input[name='ic-hf-se']").setAttribute("value",null),IconCaptchaPolyfills.empty(i),i.insertAdjacentHTML("beforeend","<div class='iconcaptcha-modal__body-icons'></div>"),v(),IconCaptchaPolyfills.trigger(l,"refreshed",{captchaId:r})}function b(e,t){void 0!==e&&void 0!==t&&(h=!0,C(),e=Math.round(e),t=Math.round(t),l.querySelector('input[name="ic-hf-se"]').setAttribute("value",[e,t,u].join(",")),l.querySelector('input[name="ic-hf-id"]').setAttribute("value",r),n.style.display="none",t=S({i:r,x:e,y:t,w:u,a:2,tk:c}),IconCaptchaPolyfills.ajax({url:o.general.validationPath,type:"POST",headers:j(c),data:{payload:t},success:function(){i.classList.remove("captcha-opacity"),O(l.querySelector(".iconcaptcha-modal__body-selection"));var e,t=_createForOfIteratorHelper(l.querySelectorAll(".iconcaptcha-modal__header, .iconcaptcha-modal__footer, .iconcaptcha-modal__body"));try{for(t.s();!(e=t.n()).done;){var a=e.value;a.parentNode.removeChild(a)}}catch(e){t.e(e)}finally{t.f()}l.classList.add("iconcaptcha-success"),l.querySelector(".iconcaptcha-modal").innerHTML+='<div class="iconcaptcha-modal__body">'+'<div class="iconcaptcha-modal__body-title">'.concat(o.messages.correct,"</div>")+'<div class="iconcaptcha-modal__body-checkmark">'.concat('<svg viewBox="0 0 98.5 98.5" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path class="checkmark" d="M81.7 17.8C73.5 9.3 62 4 49.2 4 24.3 4 4 24.3 4 49.2s20.3 45.2 45.2 45.2 45.2-20.3 45.2-45.2c0-8.6-2.4-16.6-6.5-23.4L45.6 68.2 24.7 47.3" fill="none" stroke-miterlimit="10" stroke-width="8"/></svg>',"</div>")+"<div class='iconcaptcha-modal__body-info'>"+"<a href='".concat(k,"' target='_blank' rel='follow' title='").concat(A,"'>IconCaptcha &copy;</a>")+"</div></div>",h=!1,IconCaptchaPolyfills.trigger(l,"success",{captchaId:r})},error:function(){return _()}}))}function _(e,t,a){a=!(2<arguments.length&&void 0!==a)||a;i.classList.remove("captcha-opacity"),O(l.querySelector(".iconcaptcha-modal__body-selection")),e=e||o.messages.incorrect.title,t=t||o.messages.incorrect.subtitle,l.classList.add("iconcaptcha-error"),i.innerHTML='<div class="iconcaptcha-modal__body-title">'.concat(e,"</div>")+'<div class="iconcaptcha-modal__body-subtitle">'.concat(t,"</div>"),h=!1,IconCaptchaPolyfills.trigger(l,"error",{captchaId:r}),a&&setTimeout(g,o.security.selectionResetDelay)}function I(){i.classList.add("captcha-opacity"),i.insertAdjacentHTML("beforeend",'<div class="captcha-loader"></div>')}function w(e){s=p=!1,!(0<arguments.length&&void 0!==e)||e?(e=S({i:r,a:3,tk:c}),IconCaptchaPolyfills.ajax({url:o.general.validationPath,type:"post",headers:j(c),data:{payload:e},success:function(){IconCaptchaPolyfills.trigger(l,"invalidated",{captchaId:r}),g()},error:function(){return _()}})):g()}function C(){null!==d&&(clearTimeout(d),d=null)}function P(e,t,a){a=2<arguments.length&&void 0!==a?a:"";_("IconCaptcha Error",t,!1),console.error(a),e&&IconCaptchaPolyfills.trigger(l,"error",{captchaId:r})}function S(e){return btoa(JSON.stringify(_objectSpread(_objectSpread({},e),{},{ts:Date.now()})))}function j(e){return e?{"X-IconCaptcha-Token":e}:{}}function O(e){if(e&&e._ic_listeners)for(var t in e._ic_listeners)e.removeEventListener(t,e._ic_listeners[t])}function T(e){var t;null!=e.currentTarget&&(t=IconCaptchaPolyfills.offset(e.currentTarget),n.style.left=Math.round(e.pageX-t.left)-8+"px",n.style.top=Math.round(e.pageY-t.top)-7+"px")}P(!0,"IconCaptcha was configured incorrectly","The IconCaptcha option `validationPath` has not been set.")};return e}();null!=window.jQuery&&function(t){t.fn.extend({iconCaptcha:function(e){var a=[];return t.each(this,function(e,t){a.push(t)}),IconCaptcha.$init(a,e)}})}(jQuery);
